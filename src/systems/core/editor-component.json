{
  "name": "editor-component",
  "master": true,
  "version": "1.0.0",
  "description": "",
  "schemas": {
    "104ad1f48518376": {
      "_id": "104ad1f48518376",
      "_name": "_Channel",
      "_inherit": ["_Component"],
      "$editorUpdateSystem": "event",
      "$editorUpdateSchema": "event",
      "$editorUpdateSchemaId": "event",
      "$editorUpdateSchemaName": "event",
      "$editorUpdateModel": "event",
      "$editorUpdateModelId": "event",
      "$editorUpdateType": "event",
      "$editorDeleteType": "event",
      "$editorUpdateBehavior": "event",
      "$editorDeleteBehavior": "event",
      "$editorUpdateComponent": "event",
      "$editorUpdateComponentId": "event",
      "$editorDeleteComponent": "event",
      "$appLogDebug": "event",
      "$appLogInfo": "event",
      "$appLogWarn": "event",
      "$appLogError": "event",
      "$appLoadSystem": "event",
      "$designerSync": "event",
      "$designerCreateBehavior": "event",
      "$designerCreateComponent": "event",
      "$designerCreateType": "event",
      "$designerCreateSchema": "event",
      "$designerCreateModel": "event",
      "$designerDeleteSchema": "event",
      "$designerDeleteModel": "event",
      "$designerDeleteType": "event",
      "$designerDeleteBehavior": "event",
      "$designerDeleteComponent": "event",
      "$designerUpdateComponent": "event",
      "$designerUpdateModel": "event",
      "$designerUpdateBehavior": "event",
      "$runtimeCreateComponent": "event",
      "$runtimeDeleteComponent": "event",
      "$runtimeUpdateComponent": "event",
      "send": "event"
    },
    "z1e592183e81ce64": {
      "_id": "z1e592183e81ce64",
      "_name": "Router",
      "_inherit": ["_Component"],
      "start": "method",
      "update": "method"
    },
    "t19b6b11ff31158d": {
      "_name": "ToolBarItem",
      "html": "link",
      "position": "property",
      "type": "property",
      "render": "method",
      "click": "event",
      "_id": "t19b6b11ff31158d",
      "_inherit": ["_Component"],
      "platform": "property"
    },
    "p1f6f51d9f111925": {
      "_name": "MenuAction",
      "html": "link",
      "position": "property",
      "type": "property",
      "hide": "method",
      "show": "method",
      "render": "method",
      "_id": "p1f6f51d9f111925",
      "_inherit": ["_Component"]
    },
    "t14a79156a81862a": {
      "_name": "MenuHeader",
      "html": "link",
      "type": "property",
      "hide": "method",
      "show": "method",
      "render": "method",
      "_id": "t14a79156a81862a",
      "_inherit": ["_Component"]
    },
    "l1d113198721599d": {
      "_name": "MenuItem",
      "html": "link",
      "position": "property",
      "type": "property",
      "name": "property",
      "platform": "property",
      "render": "method",
      "click": "event",
      "_id": "l1d113198721599d",
      "_inherit": ["_Component"]
    },
    "f1092816b571e03c": {
      "_name": "Workspace",
      "create": "method",
      "load": "method",
      "clear": "method",
      "render": "method",
      "_id": "f1092816b571e03c",
      "_inherit": ["_Component"]
    },
    "o1ead8184af1a83e": {
      "_name": "Designer",
      "_inherit": ["_Component"],
      "version": "property",
      "runWindow": "property",
      "debugWindow": "property",
      "linkModel": "method",
      "save": "method",
      "saveCordova": "method",
      "saveAs": "method",
      "welcome": "method",
      "open": "method",
      "render": "event",
      "isCordova": "method",
      "isElectron": "method",
      "updateCordovaContext": "method",
      "runMessages": "method",
      "installExtensions": "method",
      "isMac": "method",
      "addShortcuts": "method",
      "_id": "o1ead8184af1a83e"
    }
  },
  "models": {
    "135c71078810af2": {
      "_id": "135c71078810af2",
      "_name": "_Channel",
      "$editorUpdateSchemaName": {
        "params": [{
          "name": "name",
          "type": "string"
        }, {
          "name": "id",
          "type": "string"
        }]
      },
      "$designerSync": {},
      "$appLoadSystem": {
        "params": [{
          "name": "system",
          "type": "object"
        }]
      },
      "$designerCreateBehavior": {
        "params": [{
          "name": "behavior",
          "type": "object"
        }]
      },
      "$editorUpdateBehavior": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "behavior",
          "type": "object"
        }]
      },
      "$designerUpdateBehavior": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "behavior",
          "type": "object"
        }]
      },
      "$editorDeleteBehavior": {
        "params": [{
          "name": "id",
          "type": "string"
        }]
      },
      "$designerDeleteBehavior": {
        "params": [{
          "name": "id",
          "type": "string"
        }]
      },
      "$designerCreateComponent": {
        "params": [{
          "name": "collection",
          "type": "string"
        }, {
          "name": "component",
          "type": "object"
        }]
      },
      "$editorUpdateComponent": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }, {
          "name": "component",
          "type": "object"
        }]
      },
      "$editorUpdateComponentId": {
        "params": [{
          "name": "oldId",
          "type": "string"
        }, {
          "name": "newId",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }]
      },
      "$designerUpdateComponent": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }, {
          "name": "component",
          "type": "object"
        }]
      },
      "$editorDeleteComponent": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }]
      },
      "$designerDeleteComponent": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }]
      },
      "$designerCreateType": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "type",
          "type": "object"
        }]
      },
      "$editorUpdateType": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "type",
          "type": "object"
        }]
      },
      "$editorDeleteType": {
        "params": [{
          "name": "id",
          "type": "string"
        }]
      },
      "$designerCreateSchema": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "schema",
          "type": "object"
        }]
      },
      "$editorUpdateSchema": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "schema",
          "type": "object"
        }]
      },
      "$editorUpdateSchemaId": {
        "params": [{
          "name": "oldId",
          "type": "string"
        }, {
          "name": "newId",
          "type": "string"
        }]
      },
      "$designerDeleteSchema": {
        "params": [{
          "name": "id",
          "type": "string"
        }]
      },
      "$designerCreateModel": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "model",
          "type": "object"
        }]
      },
      "$editorUpdateModel": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "model",
          "type": "object"
        }]
      },
      "$designerUpdateModel": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "model",
          "type": "object"
        }]
      },
      "$editorUpdateModelId": {
        "params": [{
          "name": "oldId",
          "type": "string"
        }, {
          "name": "newId",
          "type": "string"
        }]
      },
      "$designerDeleteModel": {
        "params": [{
          "name": "id",
          "type": "string"
        }]
      },
      "$designerDeleteType": {
        "params": [{
          "name": "id",
          "type": "string"
        }]
      },
      "$editorUpdateSystem": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "system",
          "type": "object"
        }]
      },
      "$appLogDebug": {
        "params": [{
          "name": "message",
          "type": "string"
        }]
      },
      "$appLogInfo": {
        "params": [{
          "name": "message",
          "type": "string"
        }]
      },
      "$appLogWarn": {
        "params": [{
          "name": "message",
          "type": "string"
        }]
      },
      "$appLogError": {
        "params": [{
          "name": "message",
          "type": "string"
        }]
      },
      "$runtimeCreateComponent": {
        "params": [{
          "name": "collection",
          "type": "string"
        }, {
          "name": "component",
          "type": "object"
        }]
      },
      "$runtimeDeleteComponent": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }]
      },
      "$runtimeUpdateComponent": {
        "params": [{
          "name": "id",
          "type": "string"
        }, {
          "name": "collection",
          "type": "string"
        }, {
          "name": "field",
          "type": "string"
        }, {
          "name": "value",
          "type": "any"
        }]
      },
      "send": {
        "params": [{
          "name": "message",
          "type": "message"
        }]
      }
    },
    "c1b00612faf188cf": {
      "_id": "c1b00612faf188cf",
      "_name": "Router",
      "start": {},
      "update": {}
    },
    "u1f4c7177bb1a459": {
      "_name": "ToolBarItem",
      "html": {
        "type": "HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "position": {
        "type": "number",
        "readOnly": false,
        "mandatory": false,
        "default": 0
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "render": {},
      "click": {},
      "_id": "u1f4c7177bb1a459",
      "platform": {
        "type": "platform",
        "readOnly": false,
        "mandatory": false,
        "default": "all"
      }
    },
    "w124ac16b591df57": {
      "_name": "MenuAction",
      "html": {
        "type": "HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "position": {
        "type": "number",
        "readOnly": false,
        "mandatory": false,
        "default": 0
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "hide": {},
      "show": {},
      "render": {},
      "_id": "w124ac16b591df57"
    },
    "f13ebe1ad331b263": {
      "_name": "MenuHeader",
      "html": {
        "type": "HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "hide": {},
      "show": {},
      "render": {},
      "_id": "f13ebe1ad331b263"
    },
    "u1f9a01abe31b3bf": {
      "_id": "u1f9a01abe31b3bf",
      "_name": "MenuItem",
      "html": {
        "type": "HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "position": {
        "type": "number",
        "readOnly": false,
        "mandatory": false,
        "default": 0
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "name": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "platform": {
        "type": "platform",
        "readOnly": false,
        "mandatory": false,
        "default": "all"
      },
      "render": {},
      "click": {}
    },
    "v1435e1809e10be7": {
      "_id": "v1435e1809e10be7",
      "_name": "Workspace",
      "create": {},
      "load": {},
      "clear": {},
      "render": {}
    },
    "q129be1c61b18285": {
      "_id": "q129be1c61b18285",
      "_name": "Designer",
      "version": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": "2.0.0-rc.4"
      },
      "runWindow": {
        "type": "object",
        "readOnly": false,
        "mandatory": false,
        "default": null
      },
      "debugWindow": {
        "type": "object",
        "readOnly": false,
        "mandatory": false,
        "default": null
      },
      "linkModel": {
        "params": [{
          "name": "source",
          "type": "string",
          "mandatory": false,
          "default": ""
        }, {
          "name": "target",
          "type": "string",
          "mandatory": false,
          "default": ""
        }]
      },
      "save": {},
      "saveCordova": {},
      "saveAs": {
        "params": [{
          "name": "data",
          "type": "object",
          "mandatory": false,
          "default": {}
        }, {
          "name": "fileName",
          "type": "string",
          "mandatory": false,
          "default": ""
        }]
      },
      "welcome": {},
      "open": {
        "params": [{
          "name": "url",
          "type": "string",
          "mandatory": false,
          "default": ""
        }, {
          "name": "target",
          "type": "string",
          "mandatory": false,
          "default": ""
        }, {
          "name": "isExt",
          "type": "boolean",
          "mandatory": false,
          "default": false
        }]
      },
      "render": {},
      "isCordova": {
        "result": "boolean"
      },
      "isElectron": {
        "result": "boolean"
      },
      "updateCordovaContext": {},
      "runMessages": {
        "params": [{
          "name": "messages",
          "type": "array",
          "mandatory": true,
          "default": []
        }]
      },
      "installExtensions": {},
      "isMac": {
        "result": "boolean"
      },
      "addShortcuts": {}
    }
  },
  "behaviors": {
    "x1013f12b661a249": {
      "_id": "x1013f12b661a249",
      "component": "wdbc51200e11z03",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-copy').tooltip('hide');\n  this.require('editor').copy(); \n}"
    },
    "v1639613d361aacf": {
      "_id": "v1639613d361aacf",
      "component": "wdbc51200e11z04",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-paste').tooltip('hide');\n  this.require('editor').paste(); \n}"
    },
    "g1706d148ae11f5d": {
      "_id": "g1706d148ae11f5d",
      "component": "1dbc51300e11z16",
      "state": "click",
      "action": "function click() {\n  $('#designer-toolbar-item-export-document').tooltip('hide');\n\n  var data = this.require('store').data();\n  var name = data._id;\n  var model = this.require('store').collection();\n  var doc = {\n    \"name\": \"component \" + name,\n    \"master\": false,\n    \"version\": \"0.0.1\",\n    \"description\": \"Component \" + name,\n    \"schemas\": {},\n    \"models\": {},\n    \"behaviors\": {},\n    \"types\": {},\n    \"components\": {}\n  };\n\n  // clean\n  doc.name = doc.name.trim();\n  doc.name = doc.name.replace(/ /gi, '-');\n  doc.name = doc.name.toLocaleLowerCase();\n\n  if (typeof doc.models[model]) {\n    doc.components[model] = {};\n  }\n\n  doc.components[model][data._id] = data;\n\n  this.require('designer').saveAs(doc, 'component.' + name.replace(/ /gi, '-').toLowerCase() + '.json');\n}"
    },
    "g1a0081da861f758": {
      "_id": "g1a0081da861f758",
      "component": "wdbc51200e11z02",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-select-all').tooltip('hide');\n  this.require('editor').selectAll(); \n}"
    },
    "q1812b16012148e4": {
      "_id": "q1812b16012148e4",
      "component": "wdbc51200e11z01",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-redo').tooltip('hide');\n  this.require('editor').redo(); \n}"
    },
    "f1f85510ffb1f7de": {
      "_id": "f1f85510ffb1f7de",
      "component": "wdbc51200e11z00",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-undo').tooltip('hide');\n  this.require('editor').undo(); \n}"
    },
    "a1ca6b1c67e16e93": {
      "_id": "a1ca6b1c67e16e93",
      "component": "1dbc51200e11617",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-help').tooltip('hide');\n  this.require('designer').open('https://system-designer.readme.io/docs/create-a-component', '_blank', true);\n}"
    },
    "u1b6fb175031cb76": {
      "_id": "u1b6fb175031cb76",
      "component": "1dbc51200e11614",
      "state": "click",
      "action": "function click() {\n  $('#designer-toolbar-item-copyright').tooltip('hide');\n  var DialogCopyright = this.require('DialogCopyright');\n  var message = this.require('copyright.html');\n  \n  DialogCopyright = new DialogCopyright({\n    'title': 'System Designer',\n    'message': message.source().replace('{{version}}', this.require('designer').version())\n  });\n  DialogCopyright.show();\n  DialogCopyright.on('ok', function () {\n    this.hide();\n  });\n}"
    },
    "n1e17b11f5d1fd1d": {
      "_id": "n1e17b11f5d1fd1d",
      "component": "1dbc51200e11613",
      "state": "click",
      "action": "function click() {\n  $('#designer-toolbar-item-save').tooltip('hide');\n  this.require('designer').save();\n}"
    },
    "s10e461a0831354a": {
      "_id": "s10e461a0831354a",
      "component": "MenuItem",
      "state": "click",
      "action": "function click() { \n  var designer = this.require('designer'),\n    editor = this.require('editor'),\n    state = this.require('state'),\n    extra = null,\n    oldContext = '',\n    context = '',\n    val = '';\n\n  state.previousMenu(state.menu());\n  state.menu(this.name());\n\n  extra = this.require('store').extra();\n  oldContext = state.previousMenu();\n  context = state.menu();\n  val = editor.getValue();\n\n  if (oldContext) {\n    if (oldContext !== 'runtimeComponent') {\n      if (extra[oldContext] === 'json') {\n        this.require('store').data()[oldContext] = JSON.parse(editor.getValue());\n      } else {\n        this.require('store').data()[oldContext] = editor.getValue();\n      }\n    } else {\n      this.require('store').data(JSON.parse(editor.getValue()));\n    }\n  }\n\n  component = this.require('store').data();\n\n  if (context !== 'runtimeComponent') {\n    if (extra[context] === 'json') {\n      editor.setEditor(extra[context], JSON.stringify(component[context], null, '\\t'), 2);\n    } else {\n      editor.setEditor(extra[context], component[context], 1, true);\n    }\n  } else {\n    editor.setEditor('json', JSON.stringify(this.require('store').data(), null, '\\t'), 2);\n  }\n}",
      "useCoreAPI": false,
      "core": false
    },
    "f1236f1ee1e1d68f": {
      "_id": "f1236f1ee1e1d68f",
      "component": "Workspace",
      "state": "render",
      "action": "function render() { \n  var Editor = null,\n    designer = null,\n    editor = null;\n\n  Editor = this.require('Editor');\n  designer = this.require('designer');\n\n  if (designer.isCordova()) {\n    editor = new Editor({\n      '_id': 'editor',\n      'type': 'codemirror',\n      'context': 'component',\n      'editor': CodeMirror($('#designer-editor')[0], {\n        lineNumbers: true,\n        styleActiveLine: true,\n        'mode': 'application/json',\n        'theme': 'eclipse',\n        'tabSize': 2,\n        'autoCloseBrackets': true\n      })\n    });\n  } else {\n    editor = new Editor({\n      '_id': 'editor',\n      'type': 'ace',\n      'context': 'component',\n      'editor': ace.edit('designer-editor')\n    });\n  }\n  \n  editor.render();\n}",
      "useCoreAPI": false,
      "core": false
    },
    "b1c1bb1ef0416898": {
      "_id": "b1c1bb1ef0416898",
      "component": "Designer",
      "state": "render",
      "action": "function render() {\n  var systemId = '',\n    system = null,\n    sys = null,\n    id = '',\n    types = null,\n    title = '',\n    collection = '',\n    self = this,\n    designer = this.require('designer'),\n    result = {},\n    property = '',\n    propName = '',\n    editor = null;\n\n  // type\n  this.require('state').type(window.location.href.split('.html')[0].split('/')[window.location.href.split('.html')[0].split('/').length - 1]);\n\n  if (this.isCordova()) {\n    this.updateCordovaContext();\n  }\n\n  // get parameters\n  id = decodeURIComponent(document.location.href.split('#')[1].split('?')[0]);\n  collection = document.location.href.split('#')[2].split('?')[0];\n  systemId = document.location.href.split('#')[3].split('?')[0];\n  \n  // set system\n  system = this.require('storage').get(systemId);\n\n  sys = this.require('factory').create(system);\n  \n  // extensions\n  this.installExtensions();\n\n  // render\n  this.require('toolbar').render();\n  this.require('workspace').render();\n  \n  // set editor\n  system = this.require('storage').get(systemId);\n  component = system.components[collection][id];\n  model = this.require('factory').getGeneratedModel(collection);\n\n  function _init(props) {\n    var propName = '',\n      position = 0,\n      menuitem = null,\n      arrId = [];\n \n    if (Object.keys(props)) {\n      // add menuitems\n      for (propName in props) {\n        self.require('db').collections().HTML.insert({\n          \"_id\": \"menu-item-property-\" + propName + \".html\",\n          \"source\": '<a id=\"designer-menu-item-property-' + propName + '\" href=\"#' + propName + '\">' + propName + '</a>'\n        });\n        arrId = self.require('db').collections().MenuItem.insert({\n          \"name\": propName,\n          \"html\": \"menu-item-property-\" + propName + \".html\",\n          \"position\": position + 10,\n          \"type\": \"component\"\n        });\n      }\n\n      // items\n      var toto = self.require('menubar').items().sort(function (itemA, itemB) {\n        var compA = runtime.require(itemA),\n          compB = runtime.require(itemB);\n\n        if (compA.position() > compB.position()) {\n          return 1;\n        }\n        if (compA.position() < compB.position()) {\n          return -1;\n        }\n        return 0;\n      });\n      // render\n      self.require('menubar').render();\n    }\n  }\n\n  this.require('store').uuid(id);\n  this.require('store').collection(collection);\n  this.require('store').data(component);\n\n  for (property in component) {\n    if (model[property] && model[property].type) {\n      switch (true) {\n        case model[property].type === 'html':\n          result[property] = 'html';\n          break;\n        case model[property].type === 'javascript':\n          result[property] = 'javascript';\n          break;\n        case model[property].type === 'css':\n          result[property] = 'css';\n          break;\n        case model[property].type === 'json':\n          result[property] = 'json';\n          break;\n        case model[property].type === 'object':\n          result[property] = 'json';\n          break;\n        case model[property].type === 'text':\n          result[property] = 'text';\n          break;\n        //case Array.isArray(model[property].type):\n        //result[property] = 'array';\n        //break;\n        default:\n          // case of object / json type\n          types = system.types;\n          if (\n            types &&\n            typeof types[model[property].type] !== 'undefined' &&\n            (types[model[property].type].type === 'object' || types[model[property].type].type === 'json')\n          ) {\n            result[property] = 'json';\n          }\n          break;\n      }\n    }\n  }\n\n  this.require('store').extra(result);\n  _init(result);\n\n  document.title = 'component ' + id + ' · system ' + system.name;\n\n  editor = this.require('editor');\n  if (Object.keys(result).length === 0) {\n    editor.setEditor('json', JSON.stringify(component, null, '\\t'), 2);\n  } else {\n    propName = Object.keys(result)[0];\n    if (result[propName] === 'json') {\n      editor.setEditor(result[propName], JSON.stringify(component[propName], null, '\\t'), 2);\n    } else {\n      editor.setEditor(result[propName], component[propName], 1, true);\n    }\n  }\n  \n  this.require('router').update();\n  \n  this.addShortcuts();\n}",
      "useCoreAPI": false,
      "core": false
    },
    "z1bac81ce5915b1d": {
      "_id": "z1bac81ce5915b1d",
      "component": "Designer",
      "state": "save",
      "action": "function save() { \n  var val = this.require('editor').getValue(),\n    designer = this.require('designer'),\n    message = this.require('message'),\n    store = this.require('store').data(),\n    state = this.require('state'),\n    extra = this.require('store').extra(),\n    factory = this.require('factory'),\n    id = '';\n\n  if (state.menu() === 'runtimeComponent') {\n    try {\n      store = JSON.parse(val);\n    } catch (e) {\n      message.danger('Can not save your component: your component has an invalid structure.');\n      return;\n    }\n\n    if (!store._id) {\n      id = decodeURIComponent(document.location.href.split('#')[1].split('?')[0]);\n      if (id) {\n        store._id = id;\n      } else {\n        store._id = factory.generateId();\n      }\n    }\n    if (store._id && store._id.indexOf(' ') !== -1) {\n      message.danger('Invalid \\'_id\\'. <br>Space is not authorized in the value of \\'_id\\'.');\n      return;\n    }\n  } else {\n    if (extra[state.menu()] === 'json') {\n      store[state.menu()] = JSON.parse(val);\n    } else {\n      store[state.menu()] = val;\n    }\n  }\n  this.require('store').data(store);\n\n  // check if ID change\n  if (this.require('store').uuid() !== this.require('store').data()._id) {\n    this.require('channel').$editorUpdateComponentId(this.require('store').uuid(), this.require('store').data()._id, this.require('store').collection());\n    this.require('channel').$editorDeleteComponent(this.require('store').uuid(), this.require('store').collection());\n\n    this.require('store').uuid(this.require('store').data()._id);\n\n    // update title\n    document.title = 'component ' + this.require('store').uuid() + ' · ' + document.title.split('·')[1].trim();\n  }\n\n  this.require('channel').$editorUpdateComponent(this.require('store').uuid(), this.require('store').collection(), this.require('store').data());\n  this.require('message').clean();\n  this.require('message').success('Component saved.');\n}",
      "useCoreAPI": false,
      "core": false
    },
    "n1e0b41437a1ee21": {
      "_id": "n1e0b41437a1ee21",
      "component": "x1f67a1a3311b2f4",
      "state": "start",
      "action": "function start() { \n  this.require('designer').render();\n}",
      "useCoreAPI": false,
      "core": false
    },
    "m169e6148951d670": {
      "_id": "m169e6148951d670",
      "component": "Router",
      "state": "update",
      "action": "function update() { \n  var menubar = [],\n    i = 0,\n    length = 0,\n    id = '',\n    systemId = '',\n    href = '';\n\n  id = decodeURIComponent(document.location.href.split('#')[1]);\n  collection = document.location.href.split('#')[2];\n  systemId = document.location.href.split('#')[3].split('?')[0];\n\n  // update menubar\n  menubar = $('#designer-menubar-items > li > a');\n  length = menubar.length;\n  for (i = 0; i < length; i++) {\n    href = menubar[i].href;\n    context = href.split('#')[href.split('#').length - 1];\n    menubar[i].href = '#' + id + '#' + collection + '#' + systemId + '#' + context;\n  }\n}",
      "useCoreAPI": false,
      "core": false
    },
    "p16e0e101141aec7": {
      "_id": "p16e0e101141aec7",
      "component": "_Channel",
      "state": "send",
      "action": "function send(message) { \n  if (message.event.indexOf('$system') !== 0) {\n    var storage = this.require('storage'),\n      config = storage.get('system-designer-config'),\n      designer = this.require('designer'),\n      messages = [];\n\n    storage.set('system-designer-message', message);\n\n    if (designer.isCordova()) {\n      messages = designer.messages();\n      messages.push(message);\n      designer.messages(messages);\n    }\n\n    // message for server debug\n    if (typeof config.debugType !== 'undefined' && config.debugType === 'server' && config.urlServer) {\n      $.post(config.urlServer + ':8888/' + message.event, encodeURIComponent(JSON.stringify(message.data)));\n    }\n  }\t\n}",
      "useCoreAPI": false,
      "core": false
    },
    "k141a418b2f1e2c1": {
      "_id": "k141a418b2f1e2c1",
      "component": "_Channel",
      "state": "init",
      "action": "function init(conf) { \n  this.require('_Storage').on('changed', function (obj) {\n    if (typeof obj['system-designer-message'] !== 'undefined') {\n      $db._Message.insert(obj['system-designer-message'].newValue);\n    }\n  }, true);\t\n}",
      "useCoreAPI": false,
      "core": false
    },
    "b1a55213199167b3": {
      "_id": "b1a55213199167b3",
      "component": "r185da17faa18ba1",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-command').tooltip('hide');\n  \n  if (this.require('factory').system()) {\n      if ($('#designer-dialog-command-modal').length) {\n        $('#designer-dialog-input-command').val('');\n        $('#designer-dialog-command-result').empty();\n        $('#designer-dialog-command-result-area').hide();\n        $('#designer-dialog-command-modal').modal('show');\n    } else {\n      var Dialog = runtime.require('DialogCommand');\n      var dialog = new Dialog({'title':''});\n      dialog.show();\n    }\t\n  } else {\n    this.require('message').warning('There is no system.');\n  }\n}",
      "useCoreAPI": false,
      "core": false
    },
    "a12e151c735189b9": {
      "_id": "a12e151c735189b9",
      "component": "z125f2124301bac8",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-command').tooltip('hide');\n  \n  if (this.require('factory').system()) {\n      if ($('#designer-dialog-command-modal').length) {\n        $('#designer-dialog-input-command').val('');\n        $('#designer-dialog-command-result').empty();\n        $('#designer-dialog-command-result-area').hide();\n        $('#designer-dialog-command-modal').modal('show');\n    } else {\n      var Dialog = runtime.require('DialogCommand');\n      var dialog = new Dialog({'title':''});\n      dialog.show();\n    }\t\n  } else {\n    this.require('message').warning('There is no system.');\n  }\n}",
      "useCoreAPI": false,
      "core": false
    },
    "n1d2851e46f12abd": {
      "_id": "n1d2851e46f12abd",
      "component": "o16271137ba1c474",
      "state": "click",
      "action": "function click() {\n  $('#designer-toolbar-item-export-document').tooltip('hide');\n\n  var data = this.require('store').data();\n  var name = data._id;\n  var model = this.require('store').collection();\n  var doc = {\n    \"name\": \"component \" + name,\n    \"master\": false,\n    \"version\": \"0.0.1\",\n    \"description\": \"Component \" + name,\n    \"schemas\": {},\n    \"models\": {},\n    \"behaviors\": {},\n    \"types\": {},\n    \"components\": {}\n  };\n\n  // clean\n  doc.name = doc.name.trim();\n  doc.name = doc.name.replace(/ /gi, '-');\n  doc.name = doc.name.toLocaleLowerCase();\n\n  if (typeof doc.models[model]) {\n    doc.components[model] = {};\n  }\n\n  doc.components[model][data._id] = data;\n\n  this.require('designer').saveAs(doc, 'component.' + name.replace(/ /gi, '-').toLowerCase() + '.json');\n}",
      "useCoreAPI": false,
      "core": false
    },
    "b14c8e1d3f9189fd": {
      "_id": "b14c8e1d3f9189fd",
      "component": "Designer",
      "state": "installExtensions",
      "action": "function installExtensions() { \n\tvar result = {};\n\treturn result;\n}",
      "useCoreAPI": false,
      "core": false
    },
    "y10fc61d1d41464f": {
      "_id": "y10fc61d1d41464f",
      "component": "Designer",
      "state": "addShortcuts",
      "action": "function addShorcuts() { \n  if (!this.isCordova()) {\n  \tif (this.isMac()) {\n      document.body.addEventListener('keydown', function keydown(event){\n        var message = this.require('message'),\n            key = event.which || event.keyCode,\n            command = event.metaKey ? event.metaKey : ((key === 91) ? true : false),\n            dialog = null,\n            Dialog = null;\n    \n        switch (true) {\n          // Command + O\n          case key === 79 && command:\n            if ($('#designer-dialog').children().length) {\n              $('#' + $(\"#designer-dialog\").children()[0].id).removeClass('fade').modal('hide');\n            }\n            Dialog = runtime.require('DialogCommand');\n            dialog = new Dialog({'title':''});\n            dialog.show();\n            event.stopPropagation();\n            event.preventDefault();\n            return false;\n            break;\n          default:\n            break;\n        }\n      }.bind(this));\n  \t} else {\n      document.body.addEventListener('keydown', function keydown(event){\n        var key = event.which || event.keyCode;\n        var ctrl = event.ctrlKey ? event.ctrlKey : ((key === 17) ? true : false);\n  \n        switch (true) {\n          // Ctrl + O\n          case key === 79 && ctrl:\n            if ($('#designer-dialog').children().length) {\n              $('#' + $(\"#designer-dialog\").children()[0].id).removeClass('fade').modal('hide');\n            }\n            Dialog = runtime.require('DialogCommand');\n            dialog = new Dialog({'title':''});\n            dialog.show();\n            event.stopPropagation();\n            event.preventDefault();\n            return false;\n            break;\n          default:\n            break;\n        }\n      }.bind(this)); \n  \t}\n  }\n}",
      "useCoreAPI": false,
      "core": false
    }
  },
  "types": {},
  "components": {
    "Router": {
      "router": {
        "_id": "router"
      }
    },
    "ToolBarItem": {
      "wdbc51200e11z03": {
        "_id": "wdbc51200e11z03",
        "html": "toolbar-item-copy.html",
        "position": 50,
        "type": "component",
        "platform": "electron"
      },
      "wdbc51200e11z04": {
        "_id": "wdbc51200e11z04",
        "html": "toolbar-item-paste.html",
        "position": 60,
        "type": "component",
        "platform": "electron"
      },
      "1dbc51300e11z16": {
        "_id": "1dbc51300e11z16",
        "html": "toolbar-item-export-document.html",
        "position": 70,
        "type": "component",
        "platform": "web"
      },
      "1dbc51200e11613": {
        "_id": "1dbc51200e11613",
        "html": "toolbar-item-save.html",
        "position": 10,
        "type": "component",
        "platform": "all"
      },
      "1dbc51200e11614": {
        "_id": "1dbc51200e11614",
        "html": "toolbar-item-copyright.html",
        "position": 90,
        "type": "component",
        "platform": "all"
      },
      "1dbc51200e11617": {
        "_id": "1dbc51200e11617",
        "html": "toolbar-item-help.html",
        "position": 80,
        "type": "component",
        "platform": "all"
      },
      "wdbc51200e11z00": {
        "_id": "wdbc51200e11z00",
        "html": "toolbar-item-undo.html",
        "position": 20,
        "type": "component",
        "platform": "all"
      },
      "wdbc51200e11z01": {
        "_id": "wdbc51200e11z01",
        "html": "toolbar-item-redo.html",
        "position": 30,
        "type": "component",
        "platform": "all"
      },
      "wdbc51200e11z02": {
        "_id": "wdbc51200e11z02",
        "html": "toolbar-item-select-all.html",
        "position": 40,
        "type": "component",
        "platform": "all"
      },
      "r185da17faa18ba1": {
        "_id": "r185da17faa18ba1",
        "html": "toolbar-item-command.html",
        "platform": "web",
        "position": 75,
        "type": "component"
      },
      "z125f2124301bac8": {
        "_id": "z125f2124301bac8",
        "html": "toolbar-item-command.html",
        "platform": "electron",
        "position": 75,
        "type": "component"
      },
      "o16271137ba1c474": {
        "_id": "o16271137ba1c474",
        "html": "toolbar-item-export-document.html",
        "platform": "electron",
        "position": 70,
        "type": "component"
      }
    },
    "Designer": {},
    "MenuItem": {
      "1f1781882618113": {
        "_id": "1f1781882618113",
        "name": "runtimeComponent",
        "html": "menu-item-component.html",
        "position": 200,
        "type": "component",
        "platform": "all"
      }
    },
    "MenuAction": {
      "1f8571164c179bj": {
        "_id": "1f8571164c179bj",
        "html": "menu-action-version.html",
        "position": 10,
        "type": "component"
      }
    },
    "MenuHeader": {
      "1fb101b99813a18": {
        "_id": "1fb101b99813a18",
        "html": "menu-header-component.html",
        "type": "component"
      }
    },
    "Workspace": {}
  },
  "_id": "x1f67a1a3311b2f4"
}
